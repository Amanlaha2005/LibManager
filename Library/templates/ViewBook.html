{% extends 'base.html' %}

{% block content %}
<h2>ðŸ“š Available Books</h2>

<!-- SEARCH BAR -->
<form method="GET" style="margin-bottom:20px;">
    <input 
        type="text" 
        name="search" 
        placeholder="Search by title or author" 
        value="{{ request.GET.search }}"
        style="width:250px;"
    >
    <button class="btn btn-primary">Search</button>
</form>

<!-- BOOK TABLE -->
<table>
    <tr>
        <th>Image</th>
        <th>Title</th>
        <th>Author</th>
        <th>ISBN</th>
        <th>Quantity</th>

        {% if user.is_staff %}
            <th>Action</th>
        {% endif %}
    </tr>

    {% for book in Books %}
    <tr>
        <td>
            {% if book.book_img %}
                <img src="{{ book.book_img.url }}" width="60" height="80" style="object-fit:cover;">
            {% else %}
                <img src="/media/book_img/default.png" width="60" height="80">
            {% endif %}
        </td>

        <td>{{ book.title }}</td>
        <td>{{ book.author }}</td>
        <td>{{ book.isbn_no }}</td>
        <td>{{ book.quantity }}</td>

        {% if user.is_staff %}
        <td>
            <a href="{% url 'EditBook' book.id %}" class="btn btn-secondary">Edit</a>
            <a href="{% url 'DeleteBook' book.id %}" class="btn btn-danger"
               onclick="return confirm('Are you sure you want to delete this book?');">
               Delete
            </a>
        </td>
        {% endif %}
    </tr>
    {% empty %}
    <tr>
        <td colspan="6">No books found.</td>
    </tr>
    {% endfor %}
</table>

{% endblock %}
